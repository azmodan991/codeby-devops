FROM wordpress:latest

VOLUME /var/www/html/

# по аналогии с volume в mysql мы делаем копирование, которое позволяет закинуть конфигурацию, если через cli не был указан volume или bind mount
# это гарантирует, что базовая работа контейнера будет работать "по умолчанию" ну или как мы и планируем 

# после мы указываем bind mount, который переопределяет наш конфиг (переопределяет файл или директорию, которую мы прокинули через COPY)
COPY ./apache-config/000-default.conf /etc/apache2/sites-available/000-default.conf

# так как мы закидываем ее в available, где хранятся все конфигурации всех виртуальных хостов (один файл - один сайт), то нужно
# включить его в enable, для чего используется следующая команда

# ну вообще, вроде этого делать не надо, потому что базовый образ wp сам это все выполняет 
RUN a2ensite 000-default

# включаем модуль, необходимый для работы самого wp
RUN a2enmod rewrite

# запускаем его не в режиме демоне
CMD ["apache2-foreground"]
